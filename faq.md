## Вопрос: Какое оборудование необходимо для шлюза на 2530

Ответ: Подборка с Aliexpress для сборки шлюза без пайки:
1.	[Модуль ESP32 16Mb Flash 8Mb SRAM для прошивки по OTA или Модуль ESP32 c 4Mb flash для прошивки без OTA](http://ali.pub/3sy77r)
2.	[Модуль CC2530 без усилителя но с внешней антенной](http://ali.pub/3sy5g6)
3.	[Отладчик СС Debubber для прошивки модуля CC2530](http://ali.pub/3sy6nx)
4.  [Набор проводов](http://ali.pub/3sy6y1)

## Вопрос: Какое оборудование необходимо для шлюза на 2538?
Ответ: Подборка с Aliexpress для сборки шлюза с минимумом пайки (только проводки):
1.	[Модуль ESP32 16Mb Flash 8Mb SRAM для прошивки по OTA или Модуль ESP32 c 4Mb flash для прошивки без OTA](http://ali.pub/485yaa)
2.	[Модуль CC2538 с усилителем СС2592](http://ali.pub/485zeq)
3.	[Программатор J-Link V9](http://ali.pub/485zyk)
4.  [Набор проводов](http://ali.pub/3sy6y1)


## Вопрос: Какую прошивку выбрать для модуля ZigBee
Ответ: Все зависит от того какой у вас модуль и усилитель.
Прошивка должна быть обязательно основана на Z-Stack 3.0.

Для прошивки через CC Debugger:
[Прошивка для модуля CC2530 без усилителя](https://github.com/Koenkk/Z-Stack-firmware/raw/master/coordinator/Z-Stack_3.0.x/bin/CC2530_20190523.zip)

[Прошивка для модуля CC2530 с усилителем СС2591](https://github.com/Koenkk/Z-Stack-firmware/raw/master/coordinator/Z-Stack_3.0.x/bin/CC2530_CC2591_20190523.zip)

[Прошивка для модуля CC2530 с усилителем СС2592](https://github.com/Koenkk/Z-Stack-firmware/raw/master/coordinator/Z-Stack_3.0.x/bin/CC2530_CC2592_20190523.zip)

Для прошивки через J-Link:
[Прошивка для модуля CC2538 с усилителем СС2592](https://github.com/antst/CC2538-ZNP-Coordinator-firmware/files/3678300/CC2538ZNP-UART-without-SBL-cc2592.hex.zip)

## Вопрос: Как прошить ESP32

Ответ:
Для первоначальной прошивки:
1. Загрузить архив с прошивальщиком (full) 
2. Подключить ESP32 к компьютеру через USB
3. Запустить прошивку через Flash.bat
4. Иногда батник неверно определяет порт, тогда можно дописать в батник --port COM7
Для дальнейшего обновления:
1. Загрузить архив с актуальной версией прошивки 
2. Распаковать его в любую папку
3. В веб интерфейсе выбрать на странице Update файл firmware.bin
4. Нажать Start update.

## Вопрос: Как прошить CC2530

Ответ:
[Инструкция 1](https://modkam.ru/?p=1188)



## Вопрос: Как прошить CC2538

Ответ:
[Инструкция 1](https://modkam.ru/?p=1188)
[Инструкция 2](https://myzigbee.ru/books/%D0%BF%D1%80%D0%BE%D1%88%D0%B8%D0%B2%D0%BA%D0%B8/page/%D0%BF%D1%80%D0%BE%D1%88%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC-%D1%81%D1%812538-%D1%81-%D0%BF%D0%BE%D0%BC%D0%BE%D1%89%D1%8C%D1%8E-j-link)



## Вопрос: Как добавлять устройства.

Ответ: Есть два способа:
1. Включить режим присоединения на странице ZigBee в веб-интерфейсе (кнопка Start Join)
2. Можно послать значение true / false в топик ZigBeeGW/bridge/config/permit_join

## Вопрос: Как добавлять новые устройства Zigbee.

Ответ: SLS Zigbee BLE шлюз автоматически сопрягается с устройствами Zigbee. После сопряжения оно появляется в списке устройств на вкладке Zigbee. Зеленым цветом помечены устройства, уже имеющие конвертер, и с которыми работа уже протестирована. Красным помечены устройства, для  которых конвертер пока отсутсвует. Вы можете помочь с добавлением устройства, предоставив скриншоты страницы устройства и лог сопряжения на страницу [ISSUE](https://github.com/slsys/Gateway/issues) проекта. Открываете новую тему добавление нового устройства с названием устройства.

## Вопрос: Как добавлять новые устройства BLE.

Ответ: SLS Zigbee BLE шлюз также может работать с устройствами BLE. Добавление BLE устройств требует непосредственного наличия устройства. Помочь с добавлением новых, можно только прислав необходимое оборудование.


## Вопрос: Как задавать правила [SimpleBind](/simplebind.md)

Ответ: Есть два формата записи:
1.	DstDeviceId
2.	Cond, DstDeviceId, DstStateName, DstStateValue (Разделение запятыми, пробелы допускаются)
где:
•	Cond - значение при котором будет выполняться правило
•	DstDeviceId - Идентификатор устройства которому будем отправлять команду
•	DstStateName - Имя состояния которое будем отправлять
•	DstStateValue - Значение которое будем отправлять
Перед значением в поле Cond можно использовать знаки сравнения. (>, <, =, !, >=, <=, !=, <>)
Можно использовать несколько правил, разделяя их точкой с запятой.
Примеры:
•	single, lamp_1, state, TOGGLE - Для кнопки, при одиночном нажатии переключает режим lamp_1
•	ON, 0x00158D00007350D9, state, OFF; OFF, 0xABCD, state, ON - Для выключателя, инвертирует режим для реле
•	single, door_lock, state, LOCK; double, door_lock, state, UNLOCK - Закрывает замок при клике, открывает при двойном
•	torsher_lamp - Передает в torsher_lamp текущее состояние
•	<40, humidifier, state, ON; >60, humidifier, state, OFF - Для датчика влажности, включает увлажнитель если влажность меньше 40% и выключает если больше 60%

Пример:
left, PTVO, state_bottom_left, TOGGLE; right, PTVO, state_bottom_right, TOGGLE

## Вопрос: Как задать цвет лампочке или RGB контроллеру
Ответ:
Необходимо отправить в состояние color json объект содержащий один из вариантов задания цвета:
1. В родном формате CIE 1931: {"x": 0.8, "y": 0.04}
2. В формате RGB: {"r": 0, "g": 255, "b": 0}
3. В формате RGB HEX: {"hex": "#RRGGBB"}
4. Тон, насыщенность: {"hue": 23525, "saturation": 80}
5. Тон: {"hue": 1665}
6. Насыщенность: {"saturation": 220}

Пример:
Отправка в топик ZigBeeGW/0x00158D00011D8CB1/set значения: {"color":{"r":0,"g":255,"b":0}}


## Вопрос: Как задать цветовую температуру лампочке

Ответ:
Необходимо отправить в состояние color_temp значение в Майред единицах измерения.
Формула для преобразования: M = 1000000 / K где K - температура в Кельвинах.

Пример:
Цветовая температура 4000К, задаем в ZigBeeGW/lamp_1/set/color_temp значение 250

## Вопрос: Как управлять аппаратными светодиодами?
Ответ:
Необходимо отправить в JSON значение в топик ZigBeeGW/led следующего содержания:
{"mode":"manual","hex":"#FFFFFF"}

mode - устанавливает режим, допустимы значения off, manual и auto
hex - значение цвета в RGB Hex формате

